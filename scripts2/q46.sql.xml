<execution_plan query="q46.sql">
  <plan_fragment fid="8" is_root="true">
            <rows_read>73049</rows_read>
        <plan_node nid="23" is_plan_root="true" display_name="MERGING-EXCHANGE" tuple-ids="9" row-size="114" limit="100" dist_mode="PARTITIONED" partition_type="UNPARTITIONED">
            <rows_returned>400</rows_returned>
        </plan_node>
  </plan_fragment>
  <plan_fragment fid="5" is_root="false">
        <data_stream_sink fid="8" nid="23" dist_mode="PARTITIONED" partition_type="UNPARTITIONED" />
        <plan_node nid="14" is_plan_root="true" display_name="TOP-N" children="13" tuple-ids="9" row-size="114" limit="100">
            <rows_returned>400</rows_returned>
        </plan_node>
        <plan_node nid="13" is_plan_root="false" display_name="HASH JOIN" children="12,22" tuple-ids="5,7,8" row-size="134" join_type="INNER JOIN" dist_mode="BROADCAST">
            <rows_returned>81180</rows_returned>
            <probe_rows>86976</probe_rows>
            <build_rows>1532000</build_rows>
        </plan_node>
        <plan_node nid="22" is_plan_root="false" display_name="EXCHANGE" children="" tuple-ids="8" row-size="29" dist_mode="BROADCAST">
            <rows_returned>1532000</rows_returned>
        </plan_node>        
        <plan_node nid="12" is_plan_root="false" display_name="HASH JOIN" children="20,21" tuple-ids="5,7" row-size="105" join_type="INNER JOIN" dist_mode="BROADCAST">
            <rows_returned>86976</rows_returned>
            <probe_rows>89932</probe_rows>
            <build_rows>3064000</build_rows>
        </plan_node>
        <plan_node nid="21" is_plan_root="false" display_name="EXCHANGE" children="" tuple-ids="7" row-size="52" dist_mode="BROADCAST">
            <rows_returned>3064000</rows_returned>
        </plan_node>        
        <plan_node nid="20" is_plan_root="false" display_name="AGGREGATE" children="19" tuple-ids="5" row-size="53">
            <rows_returned>89932</rows_returned>
        </plan_node>
        <plan_node nid="19" is_plan_root="false" display_name="EXCHANGE" children="" tuple-ids="5" row-size="53" dist_mode="PARTITIONED" partition_type="HASH">
            <rows_returned>89932</rows_returned>
        </plan_node>
  </plan_fragment>
  <plan_fragment fid="7" is_root="false">
        <data_stream_sink fid="5" nid="22" dist_mode="BROADCAST" />
        <plan_node nid="11" is_plan_root="true" display_name="SCAN HDFS" database_name="tpcds_text" table="customer_address_text" partitions="1/1" tuple-ids="8" row-size="29">
            <rows_read>383000</rows_read>
            <rows_returned>383000</rows_returned>
        </plan_node>
  </plan_fragment>
  <plan_fragment fid="6" is_root="false">
        <data_stream_sink fid="5" nid="21" dist_mode="BROADCAST" />
        <plan_node nid="10" is_plan_root="true" display_name="SCAN HDFS" database_name="tpcds_text" table="customer_text" partitions="1/1" tuple-ids="7" row-size="52">
            <rows_read>766000</rows_read>
            <rows_returned>766000</rows_returned>
        </plan_node>
  </plan_fragment>
  <plan_fragment fid="0" is_root="false">
        <data_stream_sink fid="5" nid="19" dist_mode="PARTITIONED" partition_type="HASH" />
        <plan_node nid="9" is_plan_root="true" display_name="AGGREGATE" children="8" tuple-ids="5" row-size="53">
            <rows_returned>89932</rows_returned>
        </plan_node>
        <plan_node nid="8" is_plan_root="false" display_name="HASH JOIN" children="7,18" tuple-ids="0,1,2,3,4" row-size="123" join_type="INNER JOIN" dist_mode="BROADCAST">
            <rows_returned>955792</rows_returned>
            <probe_rows>961752</probe_rows>
            <build_rows>1532000</build_rows>
        </plan_node>
        <plan_node nid="18" is_plan_root="false" display_name="EXCHANGE" children="" tuple-ids="4" row-size="29" dist_mode="BROADCAST">
            <rows_returned>1532000</rows_returned>
        </plan_node>        
        <plan_node nid="7" is_plan_root="false" display_name="HASH JOIN" children="6,17" tuple-ids="0,1,2,3" row-size="94" join_type="INNER JOIN" dist_mode="BROADCAST">
            <rows_returned>961752</rows_returned>
            <probe_rows>3894624</probe_rows>
            <build_rows>7200</build_rows>
        </plan_node>
        <plan_node nid="17" is_plan_root="false" display_name="EXCHANGE" children="" tuple-ids="3" row-size="12" dist_mode="BROADCAST">
            <rows_returned>7200</rows_returned>
        </plan_node>        
        <plan_node nid="6" is_plan_root="false" display_name="HASH JOIN" children="5,16" tuple-ids="0,1,2" row-size="82" join_type="INNER JOIN" dist_mode="BROADCAST">
            <rows_returned>3894624</rows_returned>
            <probe_rows>23937992</probe_rows>
            <build_rows>84</build_rows>
        </plan_node>
        <plan_node nid="16" is_plan_root="false" display_name="EXCHANGE" children="" tuple-ids="2" row-size="30" dist_mode="BROADCAST">
            <rows_returned>84</rows_returned>
        </plan_node>        
        <plan_node nid="5" is_plan_root="false" display_name="HASH JOIN" children="0,15" tuple-ids="0,1" row-size="52" join_type="INNER JOIN" dist_mode="BROADCAST">
            <rows_returned>23937992</rows_returned>
            <probe_rows>23937992</probe_rows>
            <build_rows>1256</build_rows>
        </plan_node>
        <plan_node nid="15" is_plan_root="false" display_name="EXCHANGE" children="" tuple-ids="1" row-size="12" dist_mode="BROADCAST">
            <rows_returned>1256</rows_returned>
        </plan_node>        
        <plan_node nid="0" is_plan_root="false" display_name="SCAN HDFS" database_name="tpcds_text" table="store_sales_text" partitions="314/1823" tuple-ids="0" row-size="40">
            <rows_read>23937992</rows_read>
            <rows_returned>23937992</rows_returned>
        </plan_node>
  </plan_fragment>
  <plan_fragment fid="4" is_root="false">
        <data_stream_sink fid="0" nid="18" dist_mode="BROADCAST" />
        <plan_node nid="4" is_plan_root="true" display_name="SCAN HDFS" database_name="tpcds_text" table="customer_address_text" partitions="1/1" tuple-ids="4" row-size="29">
            <rows_read>383000</rows_read>
            <rows_returned>383000</rows_returned>
        </plan_node>
  </plan_fragment>
  <plan_fragment fid="3" is_root="false">
        <data_stream_sink fid="0" nid="17" dist_mode="BROADCAST" />
        <plan_node nid="3" is_plan_root="true" display_name="SCAN HDFS" database_name="tpcds_text" table="household_demographics_text" partitions="1/1" tuple-ids="3" row-size="12">
            <rows_read>7200</rows_read>
            <rows_returned>1800</rows_returned>
        </plan_node>
  </plan_fragment>
  <plan_fragment fid="2" is_root="false">
        <data_stream_sink fid="0" nid="16" dist_mode="BROADCAST" />
        <plan_node nid="2" is_plan_root="true" display_name="SCAN HDFS" database_name="tpcds_text" table="store_text" partitions="1/1" tuple-ids="2" row-size="30">
            <rows_read>144</rows_read>
            <rows_returned>21</rows_returned>
        </plan_node>
  </plan_fragment>
  <plan_fragment fid="1" is_root="false">
        <data_stream_sink fid="0" nid="15" dist_mode="BROADCAST" />
        <plan_node nid="1" is_plan_root="true" display_name="SCAN HDFS" database_name="tpcds_text" table="date_dim_text" partitions="1/1" tuple-ids="1" row-size="12">
            <rows_read>73049</rows_read>
            <rows_returned>314</rows_returned>
        </plan_node>
  </plan_fragment>
</execution_plan>

